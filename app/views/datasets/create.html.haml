%h2= "Dataset: #{@dataset.title}"

.active-scaffold
  - if @dataset.valid?
    - form_for @dataset, :url => url_for(:controller => :datasets, :action => :upload, :id => @dataset.id) do |f|
      = error_messages_for @dataset
      %h4 Dataset title
      %dl
        %dt= label_tag 'title'
        %dd= f.text_field :title, :class => 'text-input'
      %h4 Provenance information
      %dl
        %dt= label_tag 'Select people', nil
        %dd= select "person", "person_id", User.all_users_names_and_ids_for_select, {:prompt => 'Select Member'}, {:onchange => 'selectPeople(this)'}
      %ul#people-list{:style => 'list-style: none;'}
        - @dataset.users.each do |user|
          %li{:onclick => "this.parentNode.removeChild(this);"}
            %input{:name => "people[]", :type => "hidden", :value => user.id}/
            = user.to_label
      %p
        You can note external scientists in the comments of a dataset.
        Please notify the project board if an external scientist has
        signed our data sharing agreement and should be able to log into
        our data portal.
      %dl
        %dt= label_tag 'comment'
        %dd= f.text_area :comment, :size => '40x7', :class => 'text-input'
      %dl
        %dt= label_tag 'Project tag list', nil
        %dd= f.text_field :projecttag_list, :class => 'text-input'
      %h4 General Metadata
      %dl
        %dt= label_tag 'abstract'
        %dd= f.text_area :abstract, :size => '40x7', :class => 'text-input'
      %dl
        %dt= label_tag 'Usage rights'
        %dd= f.text_area :usagerights, :size => '40x7', :class => 'text-input'
      %dl
        %dt= label_tag 'published'
        %dd= f.text_area :published, :size => '40x7', :class => 'text-input'
      %dl
        %dt= label_tag 'Spatial extent'
        %dd= f.text_area :spatialextent, :size => '40x7', :class => 'text-input'
      %dl
        %dt= label_tag 'Research start date'
        %dd= f.datetime_select :datemin, :default => @dataset.datemin
      %dl
        %dt= label_tag 'Research end date'
        %dd= f.datetime_select :datemax, :default => @dataset.datemax
      %dl
        %dt= label_tag 'Temporal extent'
        %dd= f.text_area :temporalextent, :size => '40x7', :class => 'text-input'
      %dl
        %dt= label_tag 'Taxonomic extent'
        %dd= f.text_area :taxonomicextent, :size => '40x7', :class => 'text-input'
      %dl
        %dt= label_tag 'design'
        %dd= f.text_area :design, :size => '40x7', :class => 'text-input'
      %dl
        %dt= label_tag 'Data analysis'
        %dd= f.text_area :dataanalysis, :size => '40x7', :class => 'text-input'
      %dl
        %dt= label_tag 'circumstances'
        %dd= f.text_area :circumstances, :size => '40x7', :class => 'text-input'
      %dl
        %dt
        %dd= submit_tag 'Save Metadata'
    / ending the form
  - else
    / context not valid
    %p
      There were problems with saving the meta data file for this
      data set.